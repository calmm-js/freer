!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines")):"function"==typeof define&&define.amd?define(["exports","infestines"],r):r(n.freer={},n.I)}(this,function(n,l){"use strict";function c(n,r){this.p=n,this.s=r}function r(n){this.v=n}function t(n){this.f=n}var d=l.curry(function(n,r){return r instanceof n}),u=function(n){return Promise.resolve(n)},p=function(r){return function(n){return new r(n)}},f=d(r),e=(0,l.id)(function(n,r){this.e=n,this.c=r}),i=function(n,r){return new e(n,r)},a=d(e),s=function(n,r){return a(n)?i(n.e,new c(n.c,r)):i(n,r)},h=function(n,r){return f(r)?n(r.v):s(r,n)},o=function(r,n){return f(n)?y(r(n.v)):s(n,function(n){return y(r(n))})},v=function(n,r){return f(n)?o(n.v,r):s(n,function(n){return o(n,r)})},y=p(r),m=l.curry(h),w=l.curry(o),g=l.curry(v),x={map:o,of:y,ap:v,chain:h},F=l.curry(function(i,o){return function t(n,r){if(f(n))return i(n.v,r);var u,e=void 0;return u=a(n)?(e=n.c,n.e):(e=y,n),o(u,function(n,r){return t(function(n,r){for(;!l.isFunction(n);){var t=n.p;for(n=n.s;!l.isFunction(t);)n=new c(t.s,n),t=t.p;var u=t(r);if(!f(u))return s(u,n);r=u.v}return n(r)}(e,n),r)},r)}}),P=F(u,function(n,r){return null!=(t=n)&&l.isFunction(t.then)?n.then(r):h(r,n);var t}),b=function(){var r=void 0,n=new Promise(function(n){return r=n});return n.v=r,n},E=d(t),j=p(t),A=F(u,function(n,r){return E(n)?h(r,function(n){var r=b(),t=void 0;n(function(n){return t=b(),r.v(n),t}).then(function(n){t=null,r.v(n)});var u=function(n){return t?(r=b(),h(e,n)):y(n)},e=function(n){return t.v(n),h(u,r)};return h(u,r)}(n.f)):h(r,n)}),N={concat:l.sndU};n.of=y,n.chain=m,n.map=w,n.ap=g,n.Free=x,n.run=function(r){return f(r)?r.v:function(n){throw Error("Expected a pure value, but got: "+r)}()},n.runAsync=P,n.from=j,n.toAsync=A,n.handler=F,n.Exception=function(){function n(n){this.value=n}var r=arguments.length&&arguments[0]||N,t=r.empty,u=r.concat,e=d(n),i=p(n),o=F(y,function(n,r){return e(n)?y(n):h(r,n)}),c=l.curryN(2,function(t){return F(y,function(n,r){return e(n)?t(n.value):h(r,n)})}),f=t?i(t()):void 0,a=function(n,t){return c(function(r){return c(function(n){return i(u(r,n))},t)},n)},s=l.curry(a),v=function(n){for(var r=arguments.length,t=arguments[--r];r;){var u=arguments[--r];t=a(u,t)}return t};return l.assocPartialU("zero",f,{raise:i,handle:c,alt:s,alts:f?function(){return 0===arguments.length?f:v.apply(null,arguments)}:v,run:o})},n.Reader=function(){var u=new function(){},e=l.curryN(2,function(t){return F(y,function(n,r){return n===u?r(t):h(r,n)})}),n=l.curry(function(r,t){return h(function(n){return e(r(n),t)},u)});return{ask:u,local:n,run:e}},n.State=function(){function n(n){this.v=n}var u=new function(){},e=d(n),i=p(n),t=F(y,function(n,r,t){return n===u?r(t,t):e(n)?r(void 0,n.v):h(function(n){return r(n,t)},n)}),r=l.curry(function(n,r){return t(r,n)});return{get:u,put:i,modify:function(t){return h(function(n){var r=t(n);return h(function(){return y(r)},i(r))},u)},run:r}},Object.defineProperty(n,"__esModule",{value:!0})});

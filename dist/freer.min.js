!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("infestines")):"function"==typeof define&&define.amd?define(["exports","infestines"],r):r((n=n||self).freer={},n.I)}(this,function(n,l){"use strict";function o(n,r){this.p=n,this.s=r}function r(n){this.f=n}var t=function(n){return n},e=function(n){return n},h=l.curry(l.isInstanceOfU),p=function(r){return e(function(n){return new r(n)})},u=function(n){return function(){}}(0,Object),i=l.inherit(function(n){this.v=n},u),c=h(i),f=l.inherit(function(n,r){this.e=n,this.c=r},u),a=function(n,r){return new f(n,r)},v=h(f),s=function(n,r){return v(n)?a(n.e,new o(n.c,r)):a(n,r)},d=function(n,r){return c(r)?n(r.v):s(r,n)},y=function(r,n){return c(n)?w(r(n.v)):s(n,function(n){return w(r(n))})},g=function(n,r){return c(n)?y(n.v,r):s(n,function(n){return y(n,r)})},w=p(i),m=l.curry(d),b=l.curry(y),x=l.curry(g),N=l.Monad(y,w,g,d),j=l.inherit(function(){},u),E=l.curry(function(e,i){return function t(n,r){if(c(n))return e(n.v,r);if(v(n)){var u=n.c;return i(n.e,function(n,r){return t(function(n,r){for(;!l.isFunction(n);){var t=n.p;for(n=n.s;!l.isFunction(t);)n=new o(t.s,n),t=t.p;var u=t(r);if(!c(u))return s(u,n);r=u.v}return n(r)}(u,n),r)},r)}return i(n,e,r)}}),F=E(l.resolve,function(n,r){return l.isThenable(n)?n.then(r):d(r,n)}),O=function(){var r=void 0,n=new Promise(function(n){return r=n});return n.v=r,n},P=h(r),U=p(r),q=E(l.resolve,function(n,r){return P(n)?d(r,function(n){var r=O(),t=void 0;n(function(n){return t=O(),r.v(n),t}).then(function(n){t=null,r.v(n)});var u=function(n){return t?(r=O(),d(e,n)):w(n)},e=function(n){return t.v(n),d(u,r)};return d(u,r)}(n.f)):d(r,n)}),A={concat:l.sndU},I=w(void 0),M=l.always(I),_=function(r,t){return function(n){return n?r:t}},k=l.curryN(2,t(_(l.id,M))),z=l.curryN(2,t(_(M,l.id))),R=function(r,t){return function(n){return d(t,r(n))}},S=function(r){return function(n){return[r,n]}},T=function(n){for(var r=[];n;)r.push(n[0]),n=n[1];return r.reverse()};n.of=w,n.chain=m,n.map=b,n.ap=x,n.Free=N,n.run=function(r){return c(r)?r.v:function(n){throw Error("Expected a pure value, but got: "+r)}()},n.runAsync=F,n.from=U,n.toAsync=q,n.Effect=j,n.handler=E,n.Exception=function(){var n=arguments.length&&arguments[0]||A,r=n.empty,u=n.concat,t=l.inherit(function(n){this.value=n},j),e=h(t),i=p(t),o=E(w,function(n,r){return e(n)?w(n):d(r,n)}),c=l.curryN(2,function(t){return E(w,function(n,r){return e(n)?t(n.value):d(r,n)})}),f=r?i(r()):void 0,a=function(n,t){return c(function(r){return c(function(n){return i(u(r,n))},t)},n)},v=l.curry(a),s=function(n){for(var r=arguments.length,t=arguments[--r];r;){var u=arguments[--r];t=a(u,t)}return t};return l.assocPartialU("zero",f,{raise:i,handle:c,alt:v,alts:f?function(){return 0===arguments.length?f:s.apply(null,arguments)}:s,run:o})},n.Reader=function(){var u=new(l.inherit(function(){},j)),e=l.curryN(2,function(t){return E(w,function(n,r){return n===u?r(t):d(r,n)})}),n=l.curry(function(r,t){return d(function(n){return e(r(n),t)},u)});return{ask:u,local:n,run:e}},n.State=function(){var u=new(l.inherit(function(){},j)),n=l.inherit(function(n){this.v=n},j),e=h(n),i=p(n),t=E(w,function(n,r,t){return n===u?r(t,t):e(n)?r(void 0,n.v):d(function(n){return r(n,t)},n)}),r=l.curry(function(n,r){return t(r,n)});return{get:u,put:i,modify:function(t){return d(function(n){var r=t(n);return d(function(){return w(r)},i(r))},u)},run:r}},n.noop=I,n.thru=function(n){for(var r=arguments.length,t=1;t<r;++t)n=d(arguments[t],n);return n},n.compose=function(){var n=arguments.length;if(!n)return w;for(var r=arguments[--n];n;)r=R(r,arguments[--n]);return r},n.pipe=function(){var n=arguments.length;if(!n)return w;for(var r=arguments[--n];n;)r=R(arguments[--n],r);return r},n.join=function(n){return d(l.id,n)},n.unless=z,n.when=k,n.sequence=function(n){for(var r=n.length,t=w(null),u=0;u<r;++u)t=g(y(S,n[u]),t);return y(T,t)},n.lift=function(r){var u=e(function(n){return r.apply(null,T(n))});return l.arityN(r.length,e(function(){for(var n=arguments.length,r=w(null),t=0;t<n;++t)r=g(y(S,arguments[t]),r);return y(u,r)}))},Object.defineProperty(n,"__esModule",{value:!0})});
